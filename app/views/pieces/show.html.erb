<h1>Pieces show page goes here</h1>

<!-- <script>

$(function() {
  $('.square a').click(
    function submitPieceMove(id, file, rank) {
      // console.log(id);         // Error, the id is not passed, results in 
                                  // wrong routing /pieces/[object%20Object]
      $.ajax("/pieces/" + id, {
        method: "PATCH",
        data: {
          file: file,
          rank: rank
        }
      });
  });
});

</script> -->

<div class="chessboard">

  <div class="grid">
    <% file = 0 %>
    <% rank = 9 %>

    <% 8.times do %>
      <% rank = rank - 1 %>
      <% 8.times do %>
        <% file = file + 1 %>
          <div class="square">
            <% if @piece_coord == [file, rank] %>
              <div class="highlight" id="selected"></div>
            <% end %>
            <!-- <a href='#' onclick="submitPieceMove(@current_piece.id, file, rank)"><%= "#{file}, #{rank}" %></a> -->
            <%= button_to piece_path(@current_piece), method: :patch, params: {piece: {file: file, rank: rank}} do %>
              <% current_piece.game.pieces.each do |piece| %>
                <% if piece.rank == rank && piece.file == file && ([piece.file]+[piece.rank]) != @piece_coord %>
                  <%= "#{piece.color} #{piece.type}" %>
                <% end %>
              <% end %>
            <% end %>
          </div>
        <% end %>
      <br />
      <% file = 0 %>
    <% end %>
  </div>

</div>